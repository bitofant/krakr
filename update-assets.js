const fs = require ('fs');
const https = require ('https');



const market_data = { "BCHEUR": { "altname": "BCHEUR", "aclass_base": "currency", "base": "BCH", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 1, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "BCHUSD": { "altname": "BCHUSD", "aclass_base": "currency", "base": "BCH", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 1, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "BCHXBT": { "altname": "BCHXBT", "aclass_base": "currency", "base": "BCH", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "DASHEUR": { "altname": "DASHEUR", "aclass_base": "currency", "base": "DASH", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "DASHUSD": { "altname": "DASHUSD", "aclass_base": "currency", "base": "DASH", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "DASHXBT": { "altname": "DASHXBT", "aclass_base": "currency", "base": "DASH", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "EOSETH": { "altname": "EOSETH", "aclass_base": "currency", "base": "EOS", "aclass_quote": "currency", "quote": "XETH", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "EOSXBT": { "altname": "EOSXBT", "aclass_base": "currency", "base": "EOS", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 7, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "GNOETH": { "altname": "GNOETH", "aclass_base": "currency", "base": "GNO", "aclass_quote": "currency", "quote": "XETH", "lot": "unit", "pair_decimals": 4, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "GNOXBT": { "altname": "GNOXBT", "aclass_base": "currency", "base": "GNO", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "USDTZUSD": { "altname": "USDTUSD", "aclass_base": "currency", "base": "USDT", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 4, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.2], [50000, 0.16], [100000, 0.12], [250000, 0.08], [500000, 0.04], [1000000, 0]], "fees_maker": [[0, 0.2], [50000, 0.16], [100000, 0.12], [250000, 0.08], [500000, 0.04], [1000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETCXETH": { "altname": "ETCETH", "aclass_base": "currency", "base": "XETC", "aclass_quote": "currency", "quote": "XETH", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETCXXBT": { "altname": "ETCXBT", "aclass_base": "currency", "base": "XETC", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2, 3], "leverage_sell": [2, 3], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETCZEUR": { "altname": "ETCEUR", "aclass_base": "currency", "base": "XETC", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETCZUSD": { "altname": "ETCUSD", "aclass_base": "currency", "base": "XETC", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHXXBT": { "altname": "ETHXBT", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2, 3, 4, 5], "leverage_sell": [2, 3, 4, 5], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHXXBT.d": { "altname": "ETHXBT.d", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZCAD": { "altname": "ETHCAD", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZCAD", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZCAD.d": { "altname": "ETHCAD.d", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZCAD", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZEUR": { "altname": "ETHEUR", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2, 3, 4, 5], "leverage_sell": [2, 3, 4, 5], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZEUR.d": { "altname": "ETHEUR.d", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZGBP": { "altname": "ETHGBP", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZGBP", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZGBP.d": { "altname": "ETHGBP.d", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZGBP", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZJPY": { "altname": "ETHJPY", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZJPY", "lot": "unit", "pair_decimals": 0, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZJPY.d": { "altname": "ETHJPY.d", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZJPY", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZUSD": { "altname": "ETHUSD", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2, 3, 4, 5], "leverage_sell": [2, 3, 4, 5], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XETHZUSD.d": { "altname": "ETHUSD.d", "aclass_base": "currency", "base": "XETH", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XICNXETH": { "altname": "ICNETH", "aclass_base": "currency", "base": "XICN", "aclass_quote": "currency", "quote": "XETH", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XICNXXBT": { "altname": "ICNXBT", "aclass_base": "currency", "base": "XICN", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XLTCXXBT": { "altname": "LTCXBT", "aclass_base": "currency", "base": "XLTC", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XLTCZEUR": { "altname": "LTCEUR", "aclass_base": "currency", "base": "XLTC", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XLTCZUSD": { "altname": "LTCUSD", "aclass_base": "currency", "base": "XLTC", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XMLNXETH": { "altname": "MLNETH", "aclass_base": "currency", "base": "XMLN", "aclass_quote": "currency", "quote": "XETH", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XMLNXXBT": { "altname": "MLNXBT", "aclass_base": "currency", "base": "XMLN", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XREPXETH": { "altname": "REPETH", "aclass_base": "currency", "base": "XREP", "aclass_quote": "currency", "quote": "XETH", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XREPXXBT": { "altname": "REPXBT", "aclass_base": "currency", "base": "XREP", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XREPZEUR": { "altname": "REPEUR", "aclass_base": "currency", "base": "XREP", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZCAD": { "altname": "XBTCAD", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZCAD", "lot": "unit", "pair_decimals": 1, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZCAD.d": { "altname": "XBTCAD.d", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZCAD", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZEUR": { "altname": "XBTEUR", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 1, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2, 3, 4, 5], "leverage_sell": [2, 3, 4, 5], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZEUR.d": { "altname": "XBTEUR.d", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZGBP": { "altname": "XBTGBP", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZGBP", "lot": "unit", "pair_decimals": 1, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZGBP.d": { "altname": "XBTGBP.d", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZGBP", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZJPY": { "altname": "XBTJPY", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZJPY", "lot": "unit", "pair_decimals": 0, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZJPY.d": { "altname": "XBTJPY.d", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZJPY", "lot": "unit", "pair_decimals": 1, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZUSD": { "altname": "XBTUSD", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 1, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2, 3, 4, 5], "leverage_sell": [2, 3, 4, 5], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXBTZUSD.d": { "altname": "XBTUSD.d", "aclass_base": "currency", "base": "XXBT", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.36], [50000, 0.34], [100000, 0.32], [250000, 0.3], [500000, 0.28], [1000000, 0.26], [2500000, 0.24], [5000000, 0.22], [10000000, 0.2]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXDGXXBT": { "altname": "XDGXBT", "aclass_base": "currency", "base": "XXDG", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 8, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXLMXXBT": { "altname": "XLMXBT", "aclass_base": "currency", "base": "XXLM", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 8, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXMRXXBT": { "altname": "XMRXBT", "aclass_base": "currency", "base": "XXMR", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 6, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2, 3], "leverage_sell": [2, 3], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXMRZEUR": { "altname": "XMREUR", "aclass_base": "currency", "base": "XXMR", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXMRZUSD": { "altname": "XMRUSD", "aclass_base": "currency", "base": "XXMR", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [2], "leverage_sell": [2], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXRPXXBT": { "altname": "XRPXBT", "aclass_base": "currency", "base": "XXRP", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 8, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXRPZEUR": { "altname": "XRPEUR", "aclass_base": "currency", "base": "XXRP", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XXRPZUSD": { "altname": "XRPUSD", "aclass_base": "currency", "base": "XXRP", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XZECXXBT": { "altname": "ZECXBT", "aclass_base": "currency", "base": "XZEC", "aclass_quote": "currency", "quote": "XXBT", "lot": "unit", "pair_decimals": 5, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XZECZEUR": { "altname": "ZECEUR", "aclass_base": "currency", "base": "XZEC", "aclass_quote": "currency", "quote": "ZEUR", "lot": "unit", "pair_decimals": 3, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 }, "XZECZUSD": { "altname": "ZECUSD", "aclass_base": "currency", "base": "XZEC", "aclass_quote": "currency", "quote": "ZUSD", "lot": "unit", "pair_decimals": 2, "lot_decimals": 8, "lot_multiplier": 1, "leverage_buy": [], "leverage_sell": [], "fees": [[0, 0.26], [50000, 0.24], [100000, 0.22], [250000, 0.2], [500000, 0.18], [1000000, 0.16], [2500000, 0.14], [5000000, 0.12], [10000000, 0.1]], "fees_maker": [[0, 0.16], [50000, 0.14], [100000, 0.12], [250000, 0.1], [500000, 0.08], [1000000, 0.06], [2500000, 0.04], [5000000, 0.02], [10000000, 0]], "fee_volume_currency": "ZUSD", "margin_call": 80, "margin_stop": 40 } }


const tags = {
	begin: '//BEGIN_CURRENCY_SECTION',
	end: '//END_CURRENCY_SECTION'
};

function updateKrakenAssets (callback) {

}

function updateCryptowatchAssets (assets, callback) {
	https.request ('https://api.cryptowat.ch/assets', req => {
		var chunks = [];
		req.on ('data', chunk => {
			chunks.push (chunk);
		});
		req.on ('end', () => {
			var cwAssets = JSON.parse (Buffer.concat (chunks).toString ('utf8')).result;
			for (var k in assets) {
				var item = assets[k];
				if (k.charAt (0) === 'Z') {
					item.cryptowatch = { symbol: '', route: '' };
					continue;
				}
				var search = item.altname.toLowerCase ();
				var found = false;

				switch (k) {
					case 'XXBT': search = 'btc'; break;
					case 'XXDG': search = 'doge'; break;
				}
				
				cwAssets.forEach (cwa => {
					if (found) return;
					if (cwa.symbol === search) {
						found = true;
						if (k !== 'XZEC') item.name = cwa.name;
						item.cryptowatch = {
							symbol: cwa.symbol,
							route: cwa.route
						};
					}
				});
				if (!found && !item.cryptowatch) item.cryptowatch = { symbol: '', route: '' };
			}
			callback ();
		});
	}).end ();
}

fs.readFile (__dirname + '/src/modules/assets.ts', 'utf8', (err, data) => {
	if (err ) throw err;
	var p1 = data.indexOf (tags.begin);
	var p2 = data.indexOf (tags.end);
	if (p1 < 0 || p2 < 0) throw Error ('tags not found');
	p1 += tags.begin.length + 1;
	var parts = [
		data.substr (0, p1),
		data.substr (p1, p2 - p1),
		data.substr (p2)
	];
	var curr = JSON.parse ('{' + parts[1] + '}');

	for (var k in curr) {
		if (!curr[k].pair) continue;
		var p = market_data[curr[k].pair];
		if (!p) {
			p = 3;
		} else {
			p = p.pair_decimals;
		}
		curr[k].price_decimals = p;
	}

	updateCryptowatchAssets (curr, () => {
		var sc = JSON.stringify (curr, null, '	');
		sc = sc.substr (2, sc.length - 3) + '	';
		parts[1] = sc;
		var joined = parts.join ('');
		fs.writeFile (__dirname + '/src/modules/assets.ts', joined, err => {
			if (err) throw err;
			//joined = joined.split ('module.exports = ').join ('export default ');
			parts = joined.split ('//TYPESCRIPT');
			for (var i = 1; i < parts.length; i++) {
				parts.splice (i, 1);
			}
			joined = parts.join ('');
			fs.writeFile (__dirname + '/htdocs/js/assets.js', joined, err => {
				if (err) throw err;
				console.log ('file written;');
			});
		});
	});
});
